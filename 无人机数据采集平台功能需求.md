## 一、平台需求说明书（缩略版结构）

### 1. 项目概述

**1.1 项目名称**
无人机环境监测数据采集与分析平台

**1.2 建设目标**

* 面向林业、森林火情、城市热岛、空气质量、土地利用变化等空中可监测场景；
* 通过无人机挂载多种传感器（多光谱、热成像、气体/颗粒物、可见光）采集数据；
* 构建一个统一的数据采集与分析平台，实现：

  * 无人机任务管理与航线下发
  * 实时遥测/传感器数据上报与可视化
  * 异常自动识别与告警
  * 历史数据管理与对比分析

**1.3 使用角色**

* 环保局人员：日常监测、预警处置、查看报表；
* 科研人员：分析历史数据、导出数据用于建模和论文。

---

### 2. 系统总体功能

可画一个简单模块图（文字描述就行）：

* 无人机接入与协议模块
* 任务与航线管理模块
* 实时监测与预警模块
* 传感器数据管理模块
* 分析与可视化模块
* 用户与权限管理模块
* 系统管理模块

---

### 3. 详细功能需求

#### 3.1 无人机接入与管理模块

* **无人机注册管理**

  * 录入/审核无人机信息：编号、机型、载荷类型（可挂哪些传感器）、通信模块（4G/5G/WiFi）。
  * 管理无人机状态：在线/离线、维护中、禁飞。

* **在线状态与遥测监控**

  * 实时显示无人机位置（经纬度、高度）、航向、速度、电量、链路质量。
  * 支持在线无人机列表与地图视图联动。

* **无人机–平台协议适配**

  * 支持基于统一协议的心跳、遥测、传感器数据、图像元数据上报。
  * 断线重连与消息重发机制（在协议规范里细化）。

> 和“协议部分”的联系：这里明确平台要“会说什么话”，后面协议规范就是把每一句话定义成消息格式。

---

#### 3.2 任务与航线管理模块

* **任务建模**

  * 支持创建任务：任务类型（林业健康、火情巡查、热岛监测、空气质量剖面、土地变化复拍）。
  * 设置任务区域（在地图上画多边形/折线）、高度、速度、采样周期、使用的传感器组合。

* **航线规划**

  * 根据任务区域生成航线（栅格扫描、剖面飞行等简单策略）。
  * 将航线与任务一并下发给指定无人机。

* **任务执行监控**

  * 查看任务进度：未开始、执行中、已完成、异常中止。
  * 支持强制终止、返航、暂停等控制命令。

> 和无人机的数据交互关系：
> 任务/航线下发 → 协议里的 `StartMission` / `UploadMission`消息；
> 执行进度 → 协议里的 `MissionStatus` 上报。

---

#### 3.3 实时监测与预警模块

* **实时监测**

  * 多种数据实时显示：遥测、环境传感器数值（温度、湿度、PM、气体）、热成像伪彩图预览、可见光缩略图等。
  * 地图叠加显示：例如在地图瓦片上叠加网格数据（PM2.5、地表温度）。

* **预警规则配置**

  * 支持按场景配置阈值：

    * 森林火情：地表温度 > 某值 + 持续时间、视野内烟雾检测概率 > 某值；
    * 空气质量：PM2.5/某气体浓度超标；
    * 林业健康：植被指数NDVI持续低于正常范围。
  * AI 模型结果（如烟雾、火点、病虫害识别）触发预警。

* **告警管理**

  * 告警弹窗、地图标注告警点；
  * 告警记录查询、导出。

> 和协议的联系：
> 无人机侧做初步检测（比如热成像中的温度阈值），可以直接上报 `Alert` 消息；
> 或者原始/半处理数据上报后，平台侧进行二次分析再产生告警。

---

#### 3.4 数据采集与管理模块

* **通用数据模型**

  * 统一定义：遥测数据、标量传感器数据（气体/颗粒物/温湿度）、光学/多光谱/热成像图像数据、任务元数据。
* **数据存储**

  * 结构化数据（遥测、传感器数值）存数据库；
  * 大文件（图像/视频）存文件存储/对象存储，数据库存索引和元数据。
* **任务数据管理**

  * 按任务、场景、时间、区域检索数据；
  * 支持导出 CSV、GeoJSON、影像打包。

---

#### 3.5 分析与可视化模块

* **林业健康**

  * 基于多光谱数据计算NDVI等指标；
  * 生成植被指数热力图、病害疑似区域图层。

* **火情监测**

  * 热成像高温点提取，烟雾识别结果叠加地图；
  * 支持时间轴播放查看火情发展过程。

* **城市热岛**

  * 地表温度分布图；
  * 不同时刻温度对比（工作日 vs 周末、昼夜对比）。

* **空气质量**

  * 垂直剖面曲线（高度 vs 浓度）、平面等值线图或热力图；
  * 多任务、多时间段对比分析。

* **土地利用变化**

  * 多时相影像对比，变化区域高亮显示。

---

#### 3.6 用户与权限管理

* 区分环保局用户与科研用户；
* 设置任务管理权限、告警处置权限、数据导出权限。

---

#### 3.7 非功能需求（简写）

* **性能**：单架无人机秒级遥测刷新，多架无人机并发接入；
* **可用性**：无人机断线自动重连，消息重发机制；
* **安全**：通信协议全程加密（TLS），设备认证，权限控制。